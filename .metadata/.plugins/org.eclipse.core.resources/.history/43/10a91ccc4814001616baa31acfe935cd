package com.buaa.weibo;

import java.io.IOException;

import org.apache.hadoop.conf.Configured;
import org.apache.hadoop.io.IntWritable;
import org.apache.hadoop.io.Text;
import org.apache.hadoop.mapreduce.Mapper;
import org.apache.hadoop.util.Tool;

import org.json.JSONObject;

/**
 * 
 * @author 李鹏
 * @time 2016年5月6日下午10:26:29
 */
public class WeiBo extends Configured implements Tool{
	private static Logger log = Logger.getLogger(WeiBo.class);
	/*
	 * 第一个Map任务：
	 * 	解析json数据，统计每个微博被关注数
	 */
	public static class Map extends Mapper<Object,Text,Text,IntWritable>{
		//实现序列化的计数器
		private IntWritable one = new IntWritable(1);
		
		@Override
		protected void map(Object key, Text value, Mapper<Object, Text, Text, IntWritable>.Context context)
				throws IOException, InterruptedException {
			String line = value.toString();//将每一行转化为字符串
			JSONObject json = new JSONObject(line);
			
			
			
		}
	}

	public int run(String[] arg0) throws Exception {
		
		return 0;
	}

}
